CREATE TABLE OWNER_TESTE.CLIENTES
(
  CODIGO INTEGER NOT NULL,
  NOME VARCHAR2(50) NOT NULL,
  CIDADE VARCHAR2(15) NOT NULL,
  UF CHAR(2) NOT NULL
);
COMMENT ON COLUMN OWNER_TESTE.CLIENTES.CODIGO IS 'Código';
COMMENT ON COLUMN OWNER_TESTE.CLIENTES.NOME IS 'Nome';
COMMENT ON COLUMN OWNER_TESTE.CLIENTES.CIDADE IS 'Cidade';
COMMENT ON COLUMN OWNER_TESTE.CLIENTES.UF IS 'UF';
CREATE PUBLIC SYNONYM CLIENTES for OWNER_TESTE.CLIENTES;


CREATE TABLE OWNER_TESTE.PRODUTOS
(
  CODIGO INTEGER NOT NULL,
  DESCRICAO VARCHAR2(100) NOT NULL,
  PRECO_VENDA NUMBER(10,2) NOT NULL
);
COMMENT ON COLUMN OWNER_TESTE.PRODUTOS.CODIGO IS 'Código';
COMMENT ON COLUMN OWNER_TESTE.PRODUTOS.DESCRICAO IS 'Descrição';
COMMENT ON COLUMN OWNER_TESTE.PRODUTOS.PRECO_VENDA IS 'Preço de venda';
CREATE PUBLIC SYNONYM PRODUTOS for OWNER_TESTE.PRODUTOS;


CREATE TABLE OWNER_TESTE.PEDIDOS_DADOS_GERAIS
(
  NRO_PEDIDO INTEGER NOT NULL,
  DATA_EMISSAO DATE DEFAULT SYSDATE,
  COD_CLIENTE INTEGER NOT NULL,
  VLR_TOTAL NUMBER(15,2) NOT NULL
);
COMMENT ON COLUMN OWNER_TESTE.PEDIDOS_DADOS_GERAIS.NRO_PEDIDO IS 'Nro Pedido';
COMMENT ON COLUMN OWNER_TESTE.PEDIDOS_DADOS_GERAIS.DATA_EMISSAO IS 'Data emissão';
COMMENT ON COLUMN OWNER_TESTE.PEDIDOS_DADOS_GERAIS.COD_CLIENTE IS 'Código cliente';
COMMENT ON COLUMN OWNER_TESTE.PEDIDOS_DADOS_GERAIS.VLR_TOTAL IS 'Valor total do Pedido';
CREATE PUBLIC SYNONYM PEDIDOS_DADOS_GERAIS for OWNER_TESTE.PEDIDOS_DADOS_GERAIS;


CREATE TABLE OWNER_TESTE.PEDIDOS_PRODUTOS
(
  AUTOINCREM INTEGER NOT NULL,
  NRO_PEDIDO INTEGER NOT NULL,
  COD_PRODUTO INTEGER NOT NULL,
  QTDE NUMBER(10,2) NOT NULL,
  VLR_UNIT NUMBER(10,2) NOT NULL,
  VLR_TOTAL NUMBER(15,2)
);
COMMENT ON COLUMN OWNER_TESTE.PEDIDOS_PRODUTOS.AUTOINCREM IS 'Autoincremento';
COMMENT ON COLUMN OWNER_TESTE.PEDIDOS_PRODUTOS.NRO_PEDIDO IS 'Nro Pedido';
COMMENT ON COLUMN OWNER_TESTE.PEDIDOS_PRODUTOS.COD_PRODUTO IS 'Código produto';
COMMENT ON COLUMN OWNER_TESTE.PEDIDOS_PRODUTOS.QTDE IS 'Quantidade';
COMMENT ON COLUMN OWNER_TESTE.PEDIDOS_PRODUTOS.VLR_UNIT IS 'Valor unitário do Produto';
COMMENT ON COLUMN OWNER_TESTE.PEDIDOS_PRODUTOS.VLR_TOTAL IS 'Valor total do Produto';
CREATE PUBLIC SYNONYM PEDIDOS_PRODUTOS for OWNER_TESTE.PEDIDOS_PRODUTOS;

ALTER TABLE OWNER_TESTE.CLIENTES 
       ADD CONSTRAINT PK_CLIENTES PRIMARY KEY (CODIGO);
ALTER TABLE OWNER_TESTE.PRODUTOS 
       ADD CONSTRAINT PK_PRODUTOS PRIMARY KEY (CODIGO);
ALTER TABLE OWNER_TESTE.PEDIDOS_DADOS_GERAIS 
       ADD CONSTRAINT PK_PED_DADOS_GERAIS PRIMARY KEY (NRO_PEDIDO);
ALTER TABLE OWNER_TESTE.PEDIDOS_PRODUTOS 
       ADD CONSTRAINT PK_PED_PRODUTOS PRIMARY KEY (AUTOINCREM);


ALTER TABLE OWNER_TESTE.PEDIDOS_DADOS_GERAIS
       ADD  ( CONSTRAINT CLIENTES#PED_DAD_GERAIS_FK      
              FOREIGN KEY (COD_CLIENTE)
                             REFERENCES CLIENTES(CODIGO) ) ;
ALTER TABLE OWNER_TESTE.PEDIDOS_PRODUTOS
       ADD  ( CONSTRAINT PED_DAD_GERAIS#PED_PROD_FK      
              FOREIGN KEY (NRO_PEDIDO)
                             REFERENCES PEDIDOS_DADOS_GERAIS(NRO_PEDIDO) ) ;
ALTER TABLE OWNER_TESTE.PEDIDOS_PRODUTOS
       ADD  ( CONSTRAINT PRODUTOS#PED_PROD_FK      
              FOREIGN KEY (COD_PRODUTO)
                             REFERENCES PRODUTOS(CODIGO) ) ;


CREATE INDEX IDX_CLIENTES
ON CLIENTES (NOME);

CREATE INDEX IDX_PRODUTOS
ON PRODUTOS (DESCRICAO);

CREATE INDEX IDX_PED_DAD_GERAIS
ON PEDIDOS_DADOS_GERAIS (COD_CLIENTE, DATA_EMISSAO);

CREATE INDEX IDX_PED_PROD
ON PEDIDOS_PRODUTOS (NRO_PEDIDO);


create sequence TESTE_SEQ
minvalue 1
maxvalue 9999999999
start with 1
increment by 1
nocache
cycle;


create or replace trigger "OWNER_TESTE".TG_BI_PEDIDOS_PRODUTOS BEFORE INSERT
ON PEDIDOS_PRODUTOS
FOR EACH ROW
Declare
 n_autoincrem PEDIDOS_PRODUTOS.AUTOINCREM%TYPE;
Begin
 Select TESTE_SEQ.NEXTVAL INTO n_autoincrem FROM DUAL;
 :NEW.AUTOINCREM := n_autoincrem; 
End;


INSERT INTO CLIENTES(CODIGO, NOME, CIDADE, UF) VALUES(1,'A1', 'Ribeirao Preto', 'SP');
INSERT INTO CLIENTES(CODIGO, NOME, CIDADE, UF) VALUES(2,'A2', 'Ribeirao Preto', 'SP');
INSERT INTO CLIENTES(CODIGO, NOME, CIDADE, UF) VALUES(3,'A3', 'Ribeirao Preto', 'SP');
INSERT INTO CLIENTES(CODIGO, NOME, CIDADE, UF) VALUES(4,'A4', 'Ribeirao Preto', 'SP');
INSERT INTO CLIENTES(CODIGO, NOME, CIDADE, UF) VALUES(5,'A5', 'Ribeirao Preto', 'SP');
INSERT INTO CLIENTES(CODIGO, NOME, CIDADE, UF) VALUES(6,'A6', 'Ribeirao Preto', 'SP');
INSERT INTO CLIENTES(CODIGO, NOME, CIDADE, UF) VALUES(7,'A7', 'Ribeirao Preto', 'SP');
INSERT INTO CLIENTES(CODIGO, NOME, CIDADE, UF) VALUES(8,'A8', 'Ribeirao Preto', 'SP');
INSERT INTO CLIENTES(CODIGO, NOME, CIDADE, UF) VALUES(9,'A9', 'Ribeirao Preto', 'SP');
INSERT INTO CLIENTES(CODIGO, NOME, CIDADE, UF) VALUES(10,'A10', 'Ribeirao Preto', 'SP');
INSERT INTO CLIENTES(CODIGO, NOME, CIDADE, UF) VALUES(11,'A11', 'Ribeirao Preto', 'SP');
INSERT INTO CLIENTES(CODIGO, NOME, CIDADE, UF) VALUES(12,'A12', 'Ribeirao Preto', 'SP');
INSERT INTO CLIENTES(CODIGO, NOME, CIDADE, UF) VALUES(13,'A13', 'Ribeirao Preto', 'SP');
INSERT INTO CLIENTES(CODIGO, NOME, CIDADE, UF) VALUES(14,'A14', 'Ribeirao Preto', 'SP');
INSERT INTO CLIENTES(CODIGO, NOME, CIDADE, UF) VALUES(15,'A15', 'Ribeirao Preto', 'SP');
INSERT INTO CLIENTES(CODIGO, NOME, CIDADE, UF) VALUES(16,'A16', 'Ribeirao Preto', 'SP');
INSERT INTO CLIENTES(CODIGO, NOME, CIDADE, UF) VALUES(17,'A17', 'Ribeirao Preto', 'SP');
INSERT INTO CLIENTES(CODIGO, NOME, CIDADE, UF) VALUES(18,'A18', 'Ribeirao Preto', 'SP');
INSERT INTO CLIENTES(CODIGO, NOME, CIDADE, UF) VALUES(19,'A19', 'Ribeirao Preto', 'SP');
INSERT INTO CLIENTES(CODIGO, NOME, CIDADE, UF) VALUES(20,'A20', 'Ribeirao Preto', 'SP');


INSERT INTO PRODUTOS(CODIGO, DESCRICAO, PRECO_VENDA) VALUES(1, 'DESC1', 1);
INSERT INTO PRODUTOS(CODIGO, DESCRICAO, PRECO_VENDA) VALUES(2, 'DESC2', 12);
INSERT INTO PRODUTOS(CODIGO, DESCRICAO, PRECO_VENDA) VALUES(3, 'DESC3', 13);
INSERT INTO PRODUTOS(CODIGO, DESCRICAO, PRECO_VENDA) VALUES(4, 'DESC4', 14);
INSERT INTO PRODUTOS(CODIGO, DESCRICAO, PRECO_VENDA) VALUES(5, 'DESC5', 15);
INSERT INTO PRODUTOS(CODIGO, DESCRICAO, PRECO_VENDA) VALUES(6, 'DESC6', 16);
INSERT INTO PRODUTOS(CODIGO, DESCRICAO, PRECO_VENDA) VALUES(7, 'DESC7', 17);
INSERT INTO PRODUTOS(CODIGO, DESCRICAO, PRECO_VENDA) VALUES(8, 'DESC8', 18);
INSERT INTO PRODUTOS(CODIGO, DESCRICAO, PRECO_VENDA) VALUES(9, 'DESC9', 19);
INSERT INTO PRODUTOS(CODIGO, DESCRICAO, PRECO_VENDA) VALUES(10, 'DESC10', 11);
INSERT INTO PRODUTOS(CODIGO, DESCRICAO, PRECO_VENDA) VALUES(11, 'DESC11', 111);
INSERT INTO PRODUTOS(CODIGO, DESCRICAO, PRECO_VENDA) VALUES(12, 'DESC12', 112);
INSERT INTO PRODUTOS(CODIGO, DESCRICAO, PRECO_VENDA) VALUES(13, 'DESC13', 113);
INSERT INTO PRODUTOS(CODIGO, DESCRICAO, PRECO_VENDA) VALUES(14, 'DESC14', 114);
INSERT INTO PRODUTOS(CODIGO, DESCRICAO, PRECO_VENDA) VALUES(15, 'DESC15', 115);
INSERT INTO PRODUTOS(CODIGO, DESCRICAO, PRECO_VENDA) VALUES(16, 'DESC16', 116);
INSERT INTO PRODUTOS(CODIGO, DESCRICAO, PRECO_VENDA) VALUES(17, 'DESC17', 117);
INSERT INTO PRODUTOS(CODIGO, DESCRICAO, PRECO_VENDA) VALUES(18, 'DESC18', 118);
INSERT INTO PRODUTOS(CODIGO, DESCRICAO, PRECO_VENDA) VALUES(19, 'DESC19', 119);
INSERT INTO PRODUTOS(CODIGO, DESCRICAO, PRECO_VENDA) VALUES(20, 'DESC20', 110);

